!function(){var e=window.calendar,n={leapMonth:e.leapMonth,lunarMonthDays:e.monthDays,toSolar:function(n,t,a){var l=this.leapMonth(n),r=!1;l+1==t&&(r=!0),l&&t>l&&--t;var u=e.lunar2solar(n,t,a,r);return[u.cYear,u.cMonth,u.cDay]},toLunar:function(n,t,a){var l,r=e.solar2lunar(n,t,a),u=this.leapMonth(r.lYear);return l=u&&(r.lMonth>u||r.isLeap)?r.lMonth+1:r.lMonth,[r.lYear,l,r.lDay]}},t=function(e){function t(e){v=d?x.fn_Y():_.fn_Y(),h=d?x.fn_M(f[0]):_.fn_M(o[0]),m=d?x.fn_D(f[0],f[1]):_.fn_D(o[0],o[1]),M&&(M.refillColumn(0,v),M.refillColumn(1,h),M.refillColumn(2,m)),e&&e()}function a(e,n){var t=JSON.parse(n),a=[];return a[0]=t[0][e[0]].value,a[1]=t[1][e[1]].value,a[2]=t[2][e[2]].value,a}function l(e){var n=JSON.stringify(e.data),t=a(e.selectedIndex,n);if(p[0]!=t[0]){var l=d?x.fn_M(t[0]):_.fn_M(t[0]);M.refillColumn(1,l),t[1]>M.data[1].length&&(M.scrollColumn(1,M.data[1].length-1),M.selectedIndex[1]=M.data[1].length-1),n=JSON.stringify(M.data),t=a(e.selectedIndex,n);var r=d?x.fn_D(t[0],t[1]):_.fn_D(t[0],t[1]);M.refillColumn(2,r),t[2]>M.data[2].length&&(M.scrollColumn(2,M.data[2].length-1),M.selectedIndex[2]=M.data[2].length-1)}else if(p[1]!=t[1]){var r=d?x.fn_D(t[0],t[1]):_.fn_D(t[0],t[1]);M.refillColumn(2,r),t[2]>M.data[2].length&&(M.scrollColumn(2,M.data[2].length-1),M.selectedIndex[2]=M.data[2].length-1)}p=t}function r(e,n){var l=JSON.stringify(e.data);a(e.selectedIndex,l);t(n)}function u(e,n){function t(){for(var n,t=M.data,l=JSON.stringify(M.data),r=0;r<t[2].length;r++)if(n=t[2][r],n.value==e[2]){M.scrollColumn(2,r),M.selectedIndex[2]=r;break}p=a(M.selectedIndex,l)}for(var l,r,u,i=M.data,o=0;o<i[0].length;o++){if(i[0][o].value==e[0]){M.scrollColumn(0,o),M.selectedIndex[0]=o,r=JSON.stringify(M.data),p=l=a(M.selectedIndex,r),u=d?x.fn_M(l[0]):_.fn_M(l[0]),M.refillColumn(1,u),function(){for(var n,r,u=M.data,i=0;i<u[1].length;i++)if(u[1][i].value==e[1]){M.scrollColumn(1,i),M.selectedIndex[1]=i,n=JSON.stringify(M.data),p=l=a(M.selectedIndex,n),r=d?x.fn_D(l[0],l[1]):_.fn_D(l[0],l[1]),M.refillColumn(2,r),t();break}}();break}}}var i={_min:e._min||[1900,1,31],_max:e._max||[1909,11,11],val:e.val||null,el:e.el||"packerDateId",submit:e.callback||null},o=i._min,f=n.toLunar(i._min[0],i._min[1],i._min[2]),c=i._max,s=n.toLunar(i._max[0],i._max[1],i._max[2]),d=(i.el,0),v=[{text:"1900",value:1900},{text:"1901",value:1901}],h=[{text:"1",value:1},{text:"2",value:2}],m=[{text:"1",value:1},{text:"2",value:2},{text:"3",value:3}],_={fn_Y:function(){for(var e,n=[],t={},a=c[0],l=o[0]-1,r=l;r<a;r++)e=r+1,t={text:e+"年",value:e},n.push(t);return n},fn_M:function(e){var n=0,t=12;M?(e==c[0]&&(t=c[1]),e==o[0]&&(n=o[1]-1)):n=o[1]-1;for(var a,l=[],r={},u=n;u<t;u++)a=u+1,r={text:a+"月",value:a},l.push(r);return l},fn_D:function(e,n){var t=this.fn_maxD(e,n),a=0;M?(e==c[0]&&n==c[1]&&(t=c[2]),e==o[0]&&n==o[1]&&(a=o[2]-1)):a=o[2]-1,data=[];for(var l,r={},u=a;u<t;u++)l=u+1,r={text:l+"日",value:l},data.push(r);return data},fn_maxD:function(e,n){if("01"==n||"03"==n||"05"==n||"07"==n||"08"==n||"10"==n||"12"==n)return 31;if("04"==n||"06"==n||"09"==n||"11"==n)return 30;if("02"==n){var t=e%4==0,a=e%100!=0,l=e%400==0;return t&&a||l?29:28}}},x={fn_Y:function(){for(var e,n=[],t={},a=s[0],l=f[0]-1,r=l;r<a;r++)e=r+1,t={text:e+"年",value:e},n.push(t);return n},fn_M:function(e){var t=0,a=12;M?(e==s[0]&&(a=s[1]),e==f[0]&&(t=f[1]-1)):t=f[1]-1;var l=n.leapMonth(e);l&&a++;for(var r,u=[],i={},o=t,c=t;c<a;c++)o+=1,l&&o>=l?(r=o-1,r=(o==l+1?"闰":"")+r):r=o,i={text:r+"月",value:o},u.push(i);return u},fn_D:function(e,n){var t=this.fn_maxD(e,n),a=0;M?(e==s[0]&&n==s[1]&&(t=s[2]),e==f[0]&&n==f[1]&&(a=f[2]-1)):a=f[2]-1;var l=["初一","初二","初三","初四","初五","初六","初七","初八","初九","初十","十一","十二","十三","十四","十五","十六","十七","十八","十九","二十","二一","二二","二三","二四","二五","二六","二七","二八","二九","三十"];data=[];for(var r,u={},i=a;i<t;i++)r=i+1,u={text:l[i],value:r},data.push(u);return data},fn_maxD:function(e,t){var a=n.leapMonth(e);return a&&t>a&&--t,n.lunarMonthDays(e,t)}};t();var M=new Picker({data:[v,h,m],selectedIndex:[0,0,0],title:"选择日期"});document.getElementById(i.el).addEventListener("click",function(){M.show(),i.val&&setTimeout(function(){u(i.val),i.val=null},0)});var p=o;return M.on("picker.change",function(){l(this)}),M.on("picker.cancel",function(){var e,t=JSON.stringify(this.data),l=a(this.selectedIndex,t);return e=d?n.toSolar(l[0],l[1],l[2]):n.toLunar(l[0],l[1],l[2]),d=!d,this.cancelEl.innerHTML=d?"选择阳历":"选择农历",r(this,function(){u(e,d)}),!1}),M.on("picker.valuechange",function(){var e,t={};d?(t.c={name:"农历",rawData:!0,value:this.selectedVal,leapMonth:n.leapMonth(this.selectedVal[0])},e=n.toSolar(this.selectedVal[0],this.selectedVal[1],this.selectedVal[2]),t.l={name:"阳历",value:e}):(e=n.toLunar(this.selectedVal[0],this.selectedVal[1],this.selectedVal[2]),t.c={name:"农历",value:e,leapMonth:n.leapMonth(e[0])},t.l={name:"阳历",rawData:!0,value:this.selectedVal}),i.submit&&i.submit(t)}),M};window.pickerDate=t}();